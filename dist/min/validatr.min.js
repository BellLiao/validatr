/*! Validatr - v0.1.0 - 2013-02-11
* https://github.com/jaymorrow/validatr
* Copyright (c) 2013 Jay Morrow; Licensed MIT */
(function(e,t,n,r){"use strict";function d(e,t){this.el=e,this.$el=n(e);if(!this.$el.length||!this.$el.is("form"))throw new Error(f+" needs a form to work.");this.isSubmit=!1,this.firstError=!1,this.options=n.extend({},n.fn[f].defualtOptions,t),this.options.template=n(this.options.template).addClass(l.base+l[this.options.theme])[0].outerHTML,this.elements=this.getElements(this.el).on("valid."+f,n.proxy(N,this)).on("invalid."+f,n.proxy(T,this)),this.el.noValidate=!0,this.$el.on("submit."+f,n.proxy(E,this)),this.$el.on("reset."+f,n.proxy(S,this))}function v(){this.elements.on({"focus.validatrelement":g,"blur.validatrelement":y}),n("input[type=radio]").on("click.validatrelement",function(e){b(e.target)})}function m(){this.elements.off(".validatrelement")}function g(e){var t=e.target;n(t).on({"change.validatrinput":function(){setTimeout(function(){b(t)},1)},"blur.validatrinput":function(){b(t)},"keyup.validatrinput":function(){t.value.length&&b(t)}})}function y(e){n(e.target).off(".validatrinput")}function b(e){if(e.type==="radio"){var r=n(t.getElementsByName(e.name)).filter("[required]");r.length&&(e=r[0])}var a=n(e),f=e.getAttribute("type"),l=i.input.required?e.required:x(e),c={valid:!0};if(e.willValidate){c.valid=e.checkValidity();if(!c.valid)return!1}else l&&(c=o.required(e)),c.valid&&e.value.length&&!s.boxes.test(f)&&(e.pattern&&(f="pattern"),o[f]&&(c=o[f](e)));if(c.valid)for(var h in u)if(u.hasOwnProperty(h)&&a.data(h)){c=u[h](e);if(!c.valid)break}return c.valid?(a.trigger("valid"),!0):(n.data(e,"validationMessage",c.message),a.trigger("invalid"),!1)}function w(e){var t=!0;return e.each(function(e,n){b(n)||(t=!1)}),t}function E(){this.isSubmit=!0,S.call(this);var e=w(this.elements);return e?this.options.valid.call(this.el,this.el):(v.call(this),this.firstError.focus(),this.isSubmit=!1,e)}function S(){m.call(this),this.firstError=!1,this.$el.find(".validatr-message").remove()}function x(e){if(e.required)return e.required==="true";var t=e.attributes,n=t.length,r=0;for(r;r<n;r+=1)if(t[r].name==="required")return e.required="true",!0;return e.required="false",!1}function T(e){if(h)return;e.preventDefault();var t=e.target,r=n(t),i=t.validationMessage||n.data(t,"validationMessage"),s=this.options,o=n(s.template.replace("{{message}}",i));if(this.isSubmit&&!this.firstError){this.firstError=r.after(o),s.position.call(this,o,r);return}if(!this.isSubmit||s.showall)N(e),r.after(o),s.position.call(this,o,r)}function N(e){n(e.target).next(".validatr-message").remove()}function C(e,t){e.css("position","absolute");var n=t.offset(),r=t.data("location")||this.options.location;s.topbottom.test(r)?(e.offset({left:n.left}),r==="top"&&e.offset({top:n.top-e.outerHeight()-2}),r==="bottom"&&e.offset({top:n.top+e.outerHeight()})):s.leftright.test(r)&&(e.offset({top:n.top+t.outerHeight()/2-e.outerHeight()/2}),r==="left"&&e.offset({left:n.left-e.outerWidth()-2}),r==="right"&&e.offset({left:n.left+t.outerWidth()+2}))}var i=function(){var n={},i=t.documentElement,s=":)",o=t.createElement("input"),u={},a={},f={};return n.input=function(n){for(var r=0,i=n.length;r<i;r++)f[n[r]]=n[r]in o;return f.list&&(f.list=!!t.createElement("datalist")&&!!e.HTMLDataListElement),f}("autocomplete autofocus list placeholder max min multiple pattern required step".split(" ")),n.inputtypes=function(e){for(var n=0,u,f,l,c=e.length;n<c;n++)o.setAttribute("type",f=e[n]),u=o.type!=="text",u&&(o.value=s,o.style.cssText="position:absolute;visibility:hidden;",/^range$/.test(f)&&o.style.WebkitAppearance!==r?(i.appendChild(o),l=t.defaultView,u=l.getComputedStyle&&l.getComputedStyle(o,null).WebkitAppearance!=="textfield"&&o.offsetHeight!==0,i.removeChild(o)):/^(search|tel)$/.test(f)||(/^(url|email)$/.test(f)?u=o.checkValidity&&o.checkValidity()===!1:u=o.value!==s)),a[e[n]]=!!u;return a}("search tel url email datetime date month week time datetime-local number range color".split(" ")),o=null,n}(),s={boxes:/checkbox|radio/i,color:/^#[0-9A-F]{6}$/i,date:/^(0[1-9]|1[012])\/(0[1-9]|[12][0-9]|3[01])\/\d{4}$/,email:/^[a-zA-Z0-9.!#$%&â€™*+\/=?\^_`{|}~\-]+@[a-zA-Z0-9\-]+(?:\.[a-zA-Z0-9\-]+)*$/,leftright:/left|right/i,time:/^([01][0-9]|2[0-3])(:([0-5][0-9])){2}$/,topbottom:/top|bottom/i,url:/https?:\/\/(\w+:{0,1}\w*@)?(\S+)(:[0-9]+)?(\/|\/([\w#!:.?+=&%@!\-\/]))?/},o={checkbox:function(e){return{valid:e.checked,message:"Please check this box if you want to proceed."}},color:function(e){return{valid:s.color.test(e.value),message:"Please enter a color in the format #xxxxxx"}},date:function(e){return{valid:s.date.test(e.value),message:"Please enter a date in the format mm/dd/yyyy"}},email:function(e){return{valid:s.email.test(e.value),message:"Please enter an email address."}},number:function(e){var t=n(e),r=isNaN(parseFloat(e.value))?!1:parseFloat(e.value),i=r!==!1?isNaN(t.attr("min"))?!1:parseFloat(t.attr("min")):r,s=r!==!1?isNaN(t.attr("max"))?!1:parseFloat(t.attr("max")):r,o=!0,u="Please enter a number";return i!==!1&&s!==!1?(o=r>=i&&r<=s,u="Please enter a number greater than or equal to "+i+" and less than or equal to "+s+"."):i!==!1?(o=r>=i,u="Please enter a number greater than or equal to "+i+"."):s!==!1&&(o=r<=s,u="Please enter a number less than or equal to "+s+"."),{valid:r!==!1&&o,message:u}},pattern:function(e){return{valid:(new RegExp(e.pattern)).test(e.value),message:"Please match the requested format."}},radio:function(e){return{valid:n(t.getElementsByName(e.name)).is(":checked"),message:"Please select one of these options."}},range:function(e){return this.number(e)},required:function(e){return s.boxes.test(e.type)?this[e.type](e):{valid:e.value.length,message:e.nodeName.toLowerCase()==="select"?"Please select an item in the list.":"Please fill out this field."}},text:function(){return{valid:!0}},time:function(e){return{valid:s.time.test(e.value),message:"Please enter a time in the format hh:mm:ss"}},url:function(e){return{valid:s.url.test(e.value),message:"Please enter a url."}}},u={match:function(e){var r=n(e).data("match"),i=t.getElementById(r)||t.getElementsByName(r)[0];return i?(n(i).off("valid.validatrinput").on("valid.validatrinput",function(){e.value===i.value&&b(e)}),{valid:e.value===i.value,message:"'"+e.name+"' does not equal '"+i.name+"'"}):{valid:!1,message:"'"+r+"' can not be found"}}},a=function(e){return e instanceof jQuery&&(e=e[0]),e},f="validatr",l={base:f+"-message ",bootstrap:"alert alert-error",jqueryui:"ui-state-error ui-corner-all",none:f+"-error"},c="button, input[type=submit], input[type=button], input[type=reset]",h=!1,p=function(){};p.prototype={addTest:function(e){var t=typeof e!="string",r=Array.prototype.slice.call(arguments,1)[0];t?n.extend(u,e):u[e]=r},getElements:function(e){return this.elements?this.elements:n(e).map(function(){return this.elements?n.makeArray(this.elements):n.makeArray(n(this).find("input, textarea, select"))}).not(c)},validateElement:function(e){if(!e)throw new Error("method requires an element");h=!0;var t=b(a(e));return h=!1,t},validateForm:function(e){var t=this.el||a(e),n;if(t.nodeName.toLowerCase()!=="form")throw new Error("you must pass a form to this method");return h=!0,n=w(this.elements||this.getElements(t)),h=!1,n}},n.fn[f]=function(e){var t=typeof e=="string",i=Array.prototype.slice.call(arguments,1),s=this,o;if(t)this.each(function(){var t;o=n.data(this,f);if(!o)throw new Error("cannot call methods on "+f+" prior to initialization; attempted to call method '"+e+"'");if(!n.isFunction(o[e]))throw new Error("no such method '"+e+"' for "+f+" widget instance");t=o[e].apply(o,i);if(t!==o&&t!==r)return s=t&&t.jquery?s.pushStack(t.get()):t,!1});else{var u;this.each(function(){o=n.data(this,f),o||(u=new p,d.call(u,this,e||{}),n.data(this,f,u))})}return s},n.fn[f].defualtOptions={showall:!1,location:"right",position:C,template:"<div>{{message}}</div>",theme:"none",valid:n.noop},n[f]=new p,n.expr[":"][f]=function(e){return e.textContent.indexOf(f)>=0}})(this,this.document,jQuery);